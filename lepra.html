<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>芯邪 薪邪 械锌械泻芯薪邪</title>
    <style>
        .static-content { 
            border-bottom: 2px solid #2ecc71; 
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        #dynamic-content {
            margin: 20px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        input, button { 
            padding: 12px;
            margin: 8px;
            border: 1px solid #2ecc71;
            border-radius: 4px;
        }
        button {
            background: #2ecc71;
            color: white;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div id="app">
        <div class="static-content">
            <h1>碉锔17 芯邪 薪邪 械锌械泻芯薪邪: 邪屑薪懈 芯斜芯薪芯懈</h1>
            <p class="alex"> 谢械泻: "邪泻谢 谐芯胁芯懈: 芦孝懈 邪谐邪 胁锌械写, 写胁邪 薪邪蟹邪写...禄"</p>
        </div>

        <div id="dynamic-content"></div>

        <form id="userForm">
            <input type="text" id="userName" placeholder="邪械 懈屑" required>
            <input type="number" id="userAge" placeholder="邪 胁芯蟹邪" required>
            <button type="button" onclick="initStory()">邪邪 泻胁械 </button>
        </form>
    </div>

    <script>
        // ======================
        // 肖校笑携
        // ======================
        const API_KEY = 'sk-27969cf26a24400dbed7a207cf18493d'; //  孝  鞋蝎 挟效
        const CORS_PROXY = 'https://cors-anywhere.herokuapp.com/'; //  斜谢懈薪泄 锌芯泻懈

        // ======================
        // 小小孝 笑
        // ======================
        function generateSeed(name, age) {
            let hash = 0;
            const combined = name + age.toString();
            for (let i = 0; i < combined.length; i++) {
                hash = (hash << 5) - hash + combined.charCodeAt(i);
                hash |= 0;
            }
            return Math.abs(hash);
        }

        const STATIC_CONFIG = {
            characters: {
                Alex: {
                    traits: " 邪懈芯薪邪谢懈 胁 芯泻邪, 胁械懈 胁 械薪芯谢芯谐懈懈",
                    phrases: [
                        "锔 协芯 薪邪邪械 蟹邪泻芯薪 懈蟹懈泻懈!", 
                        " 邪泻谢 薪懈泻芯谐写邪 薪械 芯懈斜邪械"
                    ]
                },
                Regina: {
                    traits: " 械胁芯泻邪  斜谢芯泻薪芯芯屑 懈芯胁",
                    phrases: [
                        " 芯胁械泄, 薪芯 锌芯胁械泄", 
                        "碉锔17 写械 芯-芯 薪械 芯写懈..."
                    ]
                }
            },
            locations: [
                " 芯屑  卸懈屑懈 邪胁薪屑懈",
                "17 邪胁泻邪 胁械屑械薪懈",
                " 谢卸 邪泻械泻"
            ]
        };

        // ======================
        // API 孝笑携
        // ======================
        async function generateStoryContent(prompt) {
            try {
                const apiUrl = CORS_PROXY + 'https://api.deepseek.com/v1/chat/completions';
                
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: "deepseek-chat",
                        messages: [{ 
                            role: "user", 
                            content: prompt + "\n\n肖芯屑邪 芯胁械邪: HTML  屑芯写蟹懈, 斜械蟹 Markdown"
                        }],
                        temperature: 0.7,
                        max_tokens: 600
                    })
                });

                if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
                
                const data = await response.json();
                const content = data.choices[0].message.content;

                if (!validateContent(content)) {
                    return "<p> 芯薪械薪 芯写械卸懈 薪械写芯锌懈屑械 谢械屑械薪</p>";
                }
                
                return content;

            } catch (error) {
                console.error(' 懈斜泻邪:', error);
                return `<p>锔 懈斜泻邪: ${error.message}</p>`;
            }
        }

        // ======================
        // 小孝鞋蝎 肖校笑
        // ======================
        function buildPrompt(seed) {
            const elements = {
                time: [" 邪胁械", " 芯谢薪芯", " 小屑械泻懈"][seed % 3],
                symbol: [" 谢-斜懈", " 械泻邪谢芯", " 小锌懈邪谢"][seed % 3],
                obstacle: [" 邪谐邪写芯薪械 谢械写", "锔17 械蟹邪邪 芯锌邪", " 芯胁芯懈泄 泻邪屑械薪"][seed % 3]
            };

            return `邪锌懈懈 邪谐屑械薪 懈芯懈懈 胁 懈谢械 屑邪谐懈械泻芯谐芯 械邪谢懈蟹屑邪:
                - 械芯薪邪卸懈: ${JSON.stringify(STATIC_CONFIG.characters, null, 2)}
                - 芯泻邪懈: ${STATIC_CONFIG.locations.join(', ')}
                - 械屑: ${elements.time}
                - 小懈屑胁芯谢: ${elements.symbol}
                - 械锌胁懈械: ${elements.obstacle}
                - 小懈谢: 70% 啸芯械 懈 芯械, 30% 写械械泻懈胁`;
        }

        function validateContent(content) {
            const forbidden = ["薪邪懈谢懈械", "锌芯谢懈懈泻邪", "械谢懈谐懈"];
            return !forbidden.some(word => content.toLowerCase().includes(word));
        }

        // ======================
        // 笑笑携
        // ======================
        async function initStory() {
            const name = document.getElementById('userName').value.trim();
            const age = document.getElementById('userAge').value;

            if (!name || !age || age < 8 || age > 100) {
                alert(" 胁械写懈械 泻芯械泻薪械 写邪薪薪械!\n屑 懈 胁芯蟹邪 (8-100)");
                return;
            }

            try {
                document.getElementById('userForm').style.display = 'none';
                document.getElementById('dynamic-content').innerHTML = " 械薪械懈械屑 懈芯懈...";

                const seed = generateSeed(name, age);
                localStorage.setItem('currentSeed', seed);
                
                const prompt = buildPrompt(seed);
                const story = await generateStoryContent(prompt);
                
                document.getElementById('dynamic-content').innerHTML = story;
                
            } catch (error) {
                document.getElementById('dynamic-content').innerHTML = 
                    `<p>17 懈懈械泻邪 芯懈斜泻邪: ${error.message}</p>`;
            }
        }

        // ======================
        // 小小孝 小小小
        // ======================
        window.onload = async () => {
            const savedSeed = localStorage.getItem('currentSeed');
            if (savedSeed) {
                document.getElementById('userForm').style.display = 'none';
                document.getElementById('dynamic-content').innerHTML = " 邪谐卸邪械屑 胁邪械 锌懈泻谢械薪懈械...";
                try {
                    const story = await generateStoryContent(buildPrompt(savedSeed));
                    document.getElementById('dynamic-content').innerHTML = story;
                } catch (error) {
                    console.error("懈斜泻邪 胁芯邪薪芯胁谢械薪懈:", error);
                }
            }
        };
    </script>
</body>
</html>

